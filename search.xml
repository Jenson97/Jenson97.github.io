<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Linux常用命令</title>
    <url>/posts/3505242605.html</url>
    <content><![CDATA[<!-- build time:Fri Dec 27 2019 21:51:09 GMT+0800 (GMT+08:00) --><blockquote><p>Linux服务器是设计出来进行业务处理应用的，在网络和计算机系统当中有广泛的应用，可以提供数据库管理和网络服务等内容，是一种性能非常高的和开源的服务器，在我国的计算机系统的客户端当中，有很多采用的就是Linux系统，其使用的范围非常广泛，用户体验反应较好。本篇博客整理了linux服务器的硬件及操作系统查询命令。</p></blockquote><h1 id="操作系统检查"><a href="#操作系统检查" class="headerlink" title="操作系统检查"></a>操作系统检查</h1><h2 id="系统"><a href="#系统" class="headerlink" title="系统"></a>系统</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看内核/操作系统/CPU信息                            </span></span><br><span class="line">uname -a        </span><br><span class="line"><span class="comment"># 查看计算机名                                         </span></span><br><span class="line">hostname</span><br><span class="line"><span class="comment"># 查看操作系统版本                                     </span></span><br><span class="line">cat /etc/redhat-release</span><br><span class="line"><span class="comment"># 查看环境变量                                         </span></span><br><span class="line">env</span><br><span class="line"><span class="comment"># 查看系统运行时间、用户数、负载                       </span></span><br><span class="line">uptime</span><br></pre></td></tr></table></figure><h2 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看内存使用量和交换区使用量                         </span></span><br><span class="line">free -g        </span><br><span class="line"><span class="comment"># 查看各分区使用情况                                   </span></span><br><span class="line">df -h        </span><br><span class="line"><span class="comment"># 查看指定目录的大小                                   </span></span><br><span class="line">du -sh &lt;目录名&gt;    </span><br><span class="line"><span class="comment"># 查看内存总量                                         </span></span><br><span class="line">grep MemTotal /proc/meminfo  </span><br><span class="line"><span class="comment"># 查看空闲内存量                                       </span></span><br><span class="line">grep MemFree /proc/meminfo  </span><br><span class="line"><span class="comment"># 查看系统负载                                         </span></span><br><span class="line">cat /proc/loadavg</span><br></pre></td></tr></table></figure><h2 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看所有网络接口的属性                               </span></span><br><span class="line">ifconfig       </span><br><span class="line"><span class="comment"># 查看防火墙设置                                       </span></span><br><span class="line">iptables -L     </span><br><span class="line"><span class="comment"># 查看路由表                                           </span></span><br><span class="line">route -n        </span><br><span class="line"><span class="comment"># 查看所有监听端口                                     </span></span><br><span class="line">netstat -lntp    </span><br><span class="line"><span class="comment"># 查看所有已经建立的连接                               </span></span><br><span class="line">netstat -antp     </span><br><span class="line"><span class="comment"># 查看网络统计信息                                     </span></span><br><span class="line">netstat -s</span><br></pre></td></tr></table></figure><h2 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看活动用户                                         </span></span><br><span class="line">w           </span><br><span class="line"><span class="comment"># 查看指定用户信息                                     </span></span><br><span class="line">id &lt;用户名&gt;      </span><br><span class="line"><span class="comment"># 查看用户登录日志                                     </span></span><br><span class="line">last          </span><br><span class="line"><span class="comment"># 查看系统所有用户                                     </span></span><br><span class="line">cut -d: -f1 /etc/passwd  </span><br><span class="line"><span class="comment"># 查看系统所有组                                       </span></span><br><span class="line">cut -d: -f1 /etc/group  </span><br><span class="line"><span class="comment"># 查看当前用户的计划任务                               </span></span><br><span class="line">crontab -l</span><br></pre></td></tr></table></figure><h1 id="硬件信息检查"><a href="#硬件信息检查" class="headerlink" title="硬件信息检查"></a>硬件信息检查</h1><h2 id="查询内核参数"><a href="#查询内核参数" class="headerlink" title="查询内核参数"></a>查询内核参数</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sysctl -n ernel.shmmni kernel.sem fs.file-max fs.aio-max-nr net.ipv4.ip_local_port_range\</span><br><span class="line">net.core.rmem_default net.core.rmem_max net.core.wmem_default net.core.wmem_max</span><br></pre></td></tr></table></figure><h2 id="查看开机启动相关命令"><a href="#查看开机启动相关命令" class="headerlink" title="查看开机启动相关命令"></a>查看开机启动相关命令</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看开机启动服务命令                                </span></span><br><span class="line">chkconfig</span><br><span class="line"><span class="comment"># 查看开机启动配置文件命令                             </span></span><br><span class="line">ls /etc/init.d</span><br><span class="line"><span class="comment"># 查看 rc 启动文件                                     </span></span><br><span class="line">cat /etc/rc.local</span><br></pre></td></tr></table></figure><h2 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看所有进程                                         </span></span><br><span class="line">ps -ef                 </span><br><span class="line"><span class="comment"># 实时显示进程状态                                     </span></span><br><span class="line">top                   </span><br><span class="line"><span class="comment"># CPU 占用最多的前 10 个进程                          </span></span><br><span class="line">ps auxw|head -1;ps auxw|sort -rn -k3|head -10  </span><br><span class="line"><span class="comment"># 内存消耗最多的前 10 个进程                          </span></span><br><span class="line">ps auxw|head -1;ps auxw|sort -rn -k4|head -10</span><br></pre></td></tr></table></figure><h2 id="查看服务器硬件信息"><a href="#查看服务器硬件信息" class="headerlink" title="查看服务器硬件信息"></a>查看服务器硬件信息</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看内核/操作系统/CPU信息                            </span></span><br><span class="line">uname -a</span><br><span class="line"><span class="comment"># 查看服务器型号、序列号                               </span></span><br><span class="line">dmidecode|grep <span class="string">"System Information"</span> -A9|egrep  <span class="string">"Manufacturer|Product|Serial"</span></span><br><span class="line"><span class="comment"># 查看主板型号                                         </span></span><br><span class="line">dmidecode |grep -A16 <span class="string">"System Information$"</span></span><br><span class="line"><span class="comment"># 查看BIOS信息                                         </span></span><br><span class="line">dmidecode -t bios</span><br><span class="line"><span class="comment"># 查看内存槽及内存条                                   </span></span><br><span class="line">dmidecode -t memory | head -45 | tail -23</span><br><span class="line"><span class="comment"># 查看网卡信息                                         </span></span><br><span class="line">dmesg | grep -i Ethernet</span><br><span class="line"><span class="comment"># 查看pci信息，即主板所有硬件槽信息                    </span></span><br><span class="line">lspci | head -10</span><br></pre></td></tr></table></figure><h2 id="查看CPU信息"><a href="#查看CPU信息" class="headerlink" title="查看CPU信息"></a>查看CPU信息</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看cpu型号                                          </span></span><br><span class="line">cat /proc/cpuinfo | grep name | cut -f2 -d: | uniq -c</span><br><span class="line"><span class="comment"># 查看系统中实际物理CPU的数量（物理）                  </span></span><br><span class="line">grep <span class="string">'physical id'</span> /proc/cpuinfo | sort | uniq | wc -l</span><br><span class="line"><span class="comment"># 系统中实际物理CPU的数量（核数）                      </span></span><br><span class="line">cat /proc/cpuinfo |grep <span class="string">'processor'</span>|wc -l</span><br><span class="line"><span class="comment"># 查看每个物理CPU中core的个数(即核数)                  </span></span><br><span class="line">cat /proc/cpuinfo |grep <span class="string">"cores"</span>|uniq</span><br><span class="line"><span class="comment"># 查看CPU的主频                                        </span></span><br><span class="line">cat /proc/cpuinfo |grep MHz|uniq</span><br><span class="line"><span class="comment"># 查看CPU的详细信息                                    </span></span><br><span class="line">cat /proc/cpuinfo | head -20</span><br><span class="line"><span class="comment"># 查看CPU的相关信息                                    </span></span><br><span class="line">lscpu</span><br><span class="line"><span class="comment"># 查看cpu运行模式                                      </span></span><br><span class="line">getconf LONG_BIT</span><br><span class="line"><span class="comment"># 查看cpu是否支持64bit                                 </span></span><br><span class="line">cat /proc/cpuinfo | grep flags | grep <span class="string">' lm '</span> | wc -l</span><br></pre></td></tr></table></figure><h2 id="查看内存信息"><a href="#查看内存信息" class="headerlink" title="查看内存信息"></a>查看内存信息</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">查看内存硬件信息                                     </span><br><span class="line">dmidecode -t memory | head -45 | tail -24</span><br><span class="line">最大支持多少内存                                     </span><br><span class="line">dmidecode|grep -P <span class="string">'Maximum\s+Capacity'</span></span><br><span class="line">Linux 查看内存的插槽数,已经使用多少插槽.每条内存多大 </span><br><span class="line">dmidecode|grep -A5 <span class="string">"Memory Device"</span>|grep Size|grep -v Range</span><br><span class="line">Linux 查看内存的频率                                 </span><br><span class="line">dmidecode|grep -A16 <span class="string">"Memory Device"</span>|grep <span class="string">'Speed'</span></span><br><span class="line">Linux 查看内存的使用情况                             </span><br><span class="line">free -h</span><br></pre></td></tr></table></figure><h2 id="查看硬盘信息"><a href="#查看硬盘信息" class="headerlink" title="查看硬盘信息"></a>查看硬盘信息</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看挂接的分区状态                                   </span></span><br><span class="line">fdisk -l |grep Disk</span><br><span class="line"><span class="comment"># 查看硬盘和分区分布                                   </span></span><br><span class="line">lsblk</span><br><span class="line"><span class="comment"># 查看硬盘和分区的详细信息                             </span></span><br><span class="line">fdisk -l</span><br><span class="line"><span class="comment"># 查看挂接的分区状态                                   </span></span><br><span class="line">mount | column -t</span><br><span class="line"><span class="comment"># 查看挂接的分区状态                                   </span></span><br><span class="line">swapon -s</span><br><span class="line"><span class="comment"># 查看硬盘使用情况                                     </span></span><br><span class="line">df -hT</span><br><span class="line"><span class="comment"># 硬盘检测命令                                         </span></span><br><span class="line">smartctl -a /dev/sda</span><br></pre></td></tr></table></figure><h2 id="查看网卡信息"><a href="#查看网卡信息" class="headerlink" title="查看网卡信息"></a>查看网卡信息</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看网卡硬件信息                                     </span></span><br><span class="line">lspci | grep -i <span class="string">'eth'</span></span><br><span class="line"><span class="comment"># 查看系统的所有网络接口                               </span></span><br><span class="line">ifconfig -a</span><br><span class="line"><span class="comment"># 查看某个网络接口的详细信息，例如eth0的详细参数和指标 </span></span><br><span class="line">ethtool eth0</span><br><span class="line"><span class="comment"># 查看所有网卡的链路状态                               </span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq 0 9`;<span class="keyword">do</span> ethtool eth<span class="variable">$&#123;i&#125;</span> | egrep <span class="string">'eth|Link'</span>;<span class="keyword">done</span></span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/posts/1243066710.html</url>
    <content><![CDATA[<!-- build time:Fri Dec 27 2019 21:51:09 GMT+0800 (GMT+08:00) --><p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p><!-- rebuild by neat -->]]></content>
  </entry>
  <entry>
    <title>表空间相关操作大全</title>
    <url>/posts/3284375276.html</url>
    <content><![CDATA[<!-- build time:Fri Dec 27 2019 21:51:09 GMT+0800 (GMT+08:00) --><blockquote><pre><code>表空间是Oracle将相关逻辑结构分组在一起的数据库存储单元。
数据库数据文件存储在表空间中。表空间（tablespaces）实际上是一个逻辑的概念，物理上并不存在。
DBA在日常管理中，表空间的管理尤为重要，关乎数据安全。本篇博客整理了一些表空间的相关操作。</code></pre></blockquote><h2 id="系统重要表空间介绍"><a href="#系统重要表空间介绍" class="headerlink" title="系统重要表空间介绍"></a>系统重要表空间介绍</h2><p><strong>SYSTEM</strong>，系统表空间，存放关于表空间名称、控制文件、数据文件等管理信息，存放着对象（如表，索引，同义词，序列）的定义信息，存放着所有pl/sql 程序（如过程，函数，包，触发器）的源代码，是oracle数据库中最重要的表空间。它属于SYS和SYSTEM，仅被SYS和SYSTEM或其他具有足够权限的用户使用。即使是SYS 和SYSTEM用户也不能删除或重命名该空间。<strong>自动管理</strong>，如发现空间占据70%以上，可考虑添加数据文件。<br><strong>SYSAUX</strong>，系统辅助表空间，用于减少system表空间的负荷，提高系统的工作效率。<br><strong>TEMP</strong> ，临时表空间，存放临时表和临时数据，用于排序。每个数据库都应该有一个（或创建一个）临时表空间，以便在创建用户时将其分配给用户，否则就会将TEMP表空间作为临时表空间。<br><strong>UNDOTBS</strong>，重做表空间，存放数据库的有关重做的相关信息和数据，日志切换频繁时需添加数据文件。<br><strong>REDO</strong>，Oracle通过Redo来保证数据库的事务可以被重演，从而使得在故障之后，数据可以被恢复。Redo对于Oracle数据库来说至关重要。在数据库中，Redo的功能主要通过3个组件来实现：Redo Log Buffer、LGWR后台进程和Redo Log File（在归档模式下，Redo Log File最终会经由ARCn进程写出为归档日志文件）。<br><strong>USERS</strong>，用户表空间，存放永久性的用户对象的数据和私有信息，因此也被称为数据表空间。每个数据库都应该有一个（或创建一个）用户表空间，以便在创建用户时将其分配给用户，否则将会使用SYSTEM表空间来保存数据。</p><h2 id="创建表空间操作"><a href="#创建表空间操作" class="headerlink" title="创建表空间操作"></a>创建表空间操作</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--标准格式</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLESPACE</span> lmtbsb </span><br><span class="line">	<span class="keyword">LOGGING</span> <span class="keyword">DATAFILE</span>  </span><br><span class="line">	<span class="string">'/u02/oracle/data/lmtbsb01.dbf'</span> </span><br><span class="line">	<span class="keyword">SIZE</span> <span class="number">32</span>M <span class="keyword">AUTOEXTEND</span> <span class="keyword">ON</span>    </span><br><span class="line">	<span class="keyword">NEXT</span> <span class="number">32</span>M <span class="keyword">MAXSIZE</span> <span class="number">2048</span>M </span><br><span class="line">	<span class="keyword">EXTENT</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">LOCAL</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--创建非标准128K扩展区的表空间</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLESPACE</span> lmtbsb </span><br><span class="line">	<span class="keyword">LOGGING</span> <span class="keyword">DATAFILE</span> </span><br><span class="line">	<span class="string">'/u02/oracle/data/lmtbsb01.dbf'</span> </span><br><span class="line">	<span class="keyword">SIZE</span> <span class="number">50</span>M </span><br><span class="line">	<span class="keyword">EXTENT</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">LOCAL</span> </span><br><span class="line">	<span class="keyword">UNIFORM</span> <span class="keyword">SIZE</span> <span class="number">128</span>K;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--SET LONG 10000</span></span><br><span class="line"><span class="keyword">SELECT</span> DBMS_METADATA.GET_DDL(<span class="string">'TABLESPACE'</span>,TABLESPACE_NAME) </span><br><span class="line">	<span class="keyword">FROM</span> DBA_TABLESPACES </span><br><span class="line">	<span class="keyword">WHERE</span> TABLESPACE_NAME=<span class="string">'USERS'</span>;</span><br></pre></td></tr></table></figure><h2 id="表空间查询操作"><a href="#表空间查询操作" class="headerlink" title="表空间查询操作"></a>表空间查询操作</h2><h3 id="查询表空间使用情况"><a href="#查询表空间使用情况" class="headerlink" title="查询表空间使用情况"></a>查询表空间使用情况</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--包含自动扩展和非自动扩展表空间使用情况，比例等，DBA常用查询</span></span><br><span class="line"><span class="comment">--set linesize 4000</span></span><br><span class="line"><span class="comment">--set pagesize 2000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> a.tablespace_name,a.autoextensible,</span><br><span class="line">               <span class="keyword">round</span>(a.bytes_alloc / <span class="number">1024</span> / <span class="number">1024</span>/<span class="number">1024</span>) alloc_GB,</span><br><span class="line">               <span class="keyword">round</span>((a.bytes_alloc - nvl(b.bytes_free, <span class="number">0</span>)) / <span class="number">1024</span> / <span class="number">1024</span>/<span class="number">1024</span>) used_GB,</span><br><span class="line">               <span class="keyword">round</span>((a.bytes_alloc - nvl(b.bytes_free, <span class="number">0</span>)) * <span class="number">100</span> /</span><br><span class="line">                     a.maxbytes) used_of_max,</span><br><span class="line">               <span class="keyword">round</span>((a.maxbytes - a.bytes_alloc + nvl(b.bytes_free, <span class="number">0</span>)) /</span><br><span class="line">                     <span class="number">1048576</span>/<span class="number">1024</span>) free_of_max_GB,</span><br><span class="line">               <span class="keyword">round</span>(a.maxbytes / <span class="number">1048576</span>/<span class="number">1024</span>) max_GB,</span><br><span class="line">                           <span class="keyword">round</span>(((a.maxbytes - a.bytes_alloc + nvl(b.bytes_free, <span class="number">0</span>))/a.maxbytes*<span class="number">100</span>),<span class="number">2</span>) ratio</span><br><span class="line">          <span class="keyword">from</span> (<span class="keyword">select</span> f.tablespace_name,f.autoextensible,</span><br><span class="line">                       <span class="keyword">sum</span>(f.bytes) bytes_alloc,</span><br><span class="line">                       <span class="keyword">sum</span>(<span class="keyword">decode</span>(f.autoextensible,</span><br><span class="line">                                  <span class="string">'YES'</span>,</span><br><span class="line">                                  f.maxbytes,</span><br><span class="line">                                  <span class="string">'NO'</span>,</span><br><span class="line">                                  f.bytes)) maxbytes</span><br><span class="line">                  <span class="keyword">from</span> dba_data_files f</span><br><span class="line">                 <span class="keyword">group</span> <span class="keyword">by</span> tablespace_name,autoextensible) a,</span><br><span class="line">               (<span class="keyword">select</span> f.tablespace_name, <span class="keyword">sum</span>(f.bytes) bytes_free</span><br><span class="line">                  <span class="keyword">from</span> dba_free_space f</span><br><span class="line">                 <span class="keyword">group</span> <span class="keyword">by</span> tablespace_name) b, dba_tablespaces</span><br><span class="line">         <span class="keyword">where</span> a.tablespace_name = b.tablespace_name <span class="keyword">and</span> a.tablespace_name=dba_tablespaces.tablespace_name;</span><br></pre></td></tr></table></figure><h3 id="查询数据文件"><a href="#查询数据文件" class="headerlink" title="查询数据文件"></a>查询数据文件</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 查询某个表空间的数据文件</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> DBA_DATA_FILES <span class="keyword">WHERE</span> TABLESPACE_NAME = <span class="string">'USER'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询临时表空间数据文件</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> DBA_TEMP_FILES D;</span><br></pre></td></tr></table></figure><h3 id="查询表空间下用户信息"><a href="#查询表空间下用户信息" class="headerlink" title="查询表空间下用户信息"></a>查询表空间下用户信息</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 查询表空间下面所有的用户</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> S.OWNER </span><br><span class="line">	<span class="keyword">FROM</span> DBA_SEGMENTS S </span><br><span class="line">	<span class="keyword">WHERE</span> S.TABLESPACE_NAME =<span class="string">'TABLESPACENAME'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看用户默认表空间、临时表空间：</span></span><br><span class="line"><span class="keyword">SELECT</span> USERNAME,TEMPORARY_TABLESPACE,</span><br><span class="line">	DEFAULT_TABLESPACE </span><br><span class="line">	<span class="keyword">FROM</span> DBA_USERS;</span><br></pre></td></tr></table></figure><h3 id="查询表空间下所有对象"><a href="#查询表空间下所有对象" class="headerlink" title="查询表空间下所有对象"></a>查询表空间下所有对象</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--删除表空间前查询表空间下所有对象</span></span><br><span class="line"><span class="keyword">SELECT</span> TABLESPACE_NAME <span class="keyword">AS</span> TABLESPACE_NAME ,</span><br><span class="line">	SEGMENT_NAME <span class="keyword">AS</span> SEGMENT_NAME , </span><br><span class="line">	<span class="keyword">SUM</span>(<span class="keyword">BYTES</span>)/<span class="number">1024</span>/<span class="number">1024</span>  <span class="keyword">AS</span> SEGMENT_SIZE  </span><br><span class="line">	<span class="keyword">FROM</span> DBA_SEGMENTS</span><br><span class="line">	<span class="keyword">WHERE</span> TABLESPACE_NAME=<span class="string">'TABLESPACENAME'</span> </span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">BY</span> TABLESPACE_NAME,SEGMENT_NAME </span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">3</span></span><br><span class="line"><span class="comment">--ORDER BY 3 按照第三列（SEGMENT_SIZE）排序</span></span><br></pre></td></tr></table></figure><h3 id="查询表空间的日志模式"><a href="#查询表空间的日志模式" class="headerlink" title="查询表空间的日志模式"></a>查询表空间的日志模式</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--使用OGG软件数据同步时需要开启logging</span></span><br><span class="line"><span class="keyword">SELECT</span> TABLESPACE_NAME,<span class="keyword">LOGGING</span> </span><br><span class="line">	<span class="keyword">FROM</span> DBA_TABLESPACES </span><br><span class="line">	<span class="keyword">WHERE</span> TABLESPACE_NAME=<span class="string">'TABLESPACENAME'</span>;</span><br></pre></td></tr></table></figure><h2 id="表空间扩展操作"><a href="#表空间扩展操作" class="headerlink" title="表空间扩展操作"></a>表空间扩展操作</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 直接修改原有数据文件大小，修改成32G，单个数据文件最大只能32G</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">DATABASE</span> <span class="keyword">DATAFILE</span> <span class="string">'/ORADATA/XXX.DBF'</span> <span class="keyword">RESIZE</span> <span class="number">32</span>G;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 给表空间增加数据文件</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLESPACE</span> DATA_ODS </span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">DATAFILE</span> <span class="string">'/oradata/xxx.dbf'</span> </span><br><span class="line"><span class="keyword">SIZE</span> <span class="number">1</span>G <span class="keyword">AUTOEXTEND</span> <span class="keyword">ON</span></span><br><span class="line"><span class="keyword">NEXT</span> <span class="number">8</span>M <span class="keyword">MAXSIZE</span> <span class="number">30</span>G;</span><br></pre></td></tr></table></figure><h2 id="表空间删除操作"><a href="#表空间删除操作" class="headerlink" title="表空间删除操作"></a>表空间删除操作</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--删除users表空间，包含目录</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLESPACE</span> <span class="keyword">users</span> <span class="keyword">INCLUDING</span> <span class="keyword">CONTENTS</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--删除users表空间，包含目录和数据文件</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLESPACE</span> <span class="keyword">users</span> <span class="keyword">INCLUDING</span> <span class="keyword">CONTENTS</span> <span class="keyword">AND</span> <span class="keyword">DATAFILES</span>;</span><br></pre></td></tr></table></figure><h2 id="表空间给用户授权和配额"><a href="#表空间给用户授权和配额" class="headerlink" title="表空间给用户授权和配额"></a>表空间给用户授权和配额</h2><blockquote><p>表空间存储限制是用户在某一个表空间中可以使用的存储空间总数。 在创建或修改用户时，可以由参数QUOTA指出。<br>若用户在向表空间存储数据时，超出了此限额，则会产生错误。 错误信息：ORA-01536:SPACE QUOTA EXCEEDED FOR TABLESPACE TABLESPACENAME..’。 可以通过查询字典DBA_TS_QUOTAS查看表空间限额信息。</p></blockquote><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--查看所有用户表空间的配额情况 </span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> DBA_TS_QUOTAS;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看当前用户表空间的配额情况   </span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> USER_TS_QUOTAS;</span><br><span class="line"><span class="comment">--更改用户的表空间限额：</span></span><br><span class="line"><span class="comment">--全局：</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">UNLIMITED</span> <span class="keyword">TABLESPACE</span> <span class="keyword">TO</span> ABC;</span><br><span class="line"><span class="comment">--针对某个表空间：</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> ABC <span class="keyword">QUOTA</span> <span class="keyword">UNLIMITED</span> <span class="keyword">ON</span> <span class="keyword">TEST</span>;</span><br><span class="line"><span class="comment">--回收：</span></span><br><span class="line"><span class="keyword">REVOKE</span> UNLIMITEDTABLESPACE <span class="keyword">FROM</span> ABC;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> ABCQUOTA <span class="number">0</span> <span class="keyword">ON</span> <span class="keyword">TEST</span>;</span><br></pre></td></tr></table></figure><p>如果没得到你想要的答案，请移步至官方文档《<a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/admin/managing-tablespaces.html#GUID-1C162C60-6698-44F2-B2A9-F3E2D2958D88" target="_blank" rel="noopener">Managing Tablespaces</a>》。</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>Oracle</category>
      </categories>
      <tags>
        <tag>Oracle</tag>
      </tags>
  </entry>
</search>
